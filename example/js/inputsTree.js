/*--------------------------------------------------------------
* @author sameh abdel moneim <http://www.github.com/seniorsam>
----------------------------------------------------------------*/
!function(s,e,t,n){var p={inputsTreeComponenets:{},inputsTags:{text:"<input></input>",email:"<input></input>",textarea:"<textarea></textarea>",checkbox:"<input>",radio:"<input>",select:"<select></select>"},init:function(e){p.inputsTreeComponenets=e,p.generatedJsonController(),s.each(p.inputsTreeComponenets.mainControllersBtns,function(e,t){p.setControllersBtn(t,"mainCat").appendTo(p.inputsTreeComponenets.inputsTreeControllersDiv)})},setControllersBtn:function(e,t){return s("<button></button>").text(e.text).on("click",function(){generatedHtmlForm=p.generateHtmlContent(p.inputsTreeComponenets.branches[e.control]),"mainCat"===t?p.inputsTreeComponenets.inputsTreeDiv.append(generatedHtmlForm):"subCat"===t&&s(this).closest(".inTreeNode").append(generatedHtmlForm)})},generateHtmlContent:function(e){var t=0;p.inputsTreeComponenets.inputsTreeDiv.find("div.inTreeNode").each(function(){var e=s(this).attr("data-inTreeNodeOrder");t<e&&(t=e)});var n=0==t?1:parseInt(t)+1,o=s("<div></div>").attr("class","inTreeNode").attr("data-inTreeNodeOrder",n).attr("data-inTreeNodealyas","n_"+n),r=s("<div></div>").attr("class","inTreeNodeControllers");return s.each(e.inputs,function(e,t){o=o.append(s("<div></div>").attr("class","inTreeInputWrapper").append(p.readInputTypeAndReturnHtmlTags(t)))}),s.each(e.subsControllersBtns,function(e,t){r=r.append(p.setControllersBtn(t,"subCat"))}),r=r.append(s("<button>delete</button>").on("click",function(){s(this).closest(".inTreeNode").remove()})),o=o.append(r)},readInputTypeAndReturnHtmlTags:function(e){var t=p.inputsTags[e.type];if(t=s(t).attr("type",e.type).attr("name",e.name).attr("class","inTreeNodeInput"),t="sclass"in e?t.addClass(e.sclass):t,t="id"in e?t.attr("id",e.id):t,t="placeholder"in e?t.attr("placeholder",e.placeholder):t,"select"===e.type){var n=s("<option></option>"),o="";"empty"in e&&(t=t.append(n.attr("value","").text(e.empty)).clone(!0)),o="DataSourceUrl"in e?p.getSelectOptionsData(e.DataSourceUrl):e.options;for(var r=0;r<o.length;r++)t=t.append(n.attr("value",o[r][e.selectOptionKey]).text(o[r][e.selectOptionValue])).clone(!0)}return t},getSelectOptionsData:function(e){var t;return s.ajax({type:"GET",url:e,dataType:"JSON",async:!1,success:function(e){t=e},fail:function(){alert("Error: While Trying To Fetch Options Values For Select Input")}}),t},generateJsonRequestAction:function(e,t){s.ajax({type:"POST",url:e,data:{it_data:t},dataType:"json",fail:function(){alert("Error: While Trying To Send Ajax Request To Action URL")}})},jsonTreeObjectBuild:function(){var i={},e=p.inputsTreeComponenets.inputsTreeDiv.find(".inTreeNode");return s.each(e,function(e,t){var n=s(t).attr("data-intreenodealyas"),o=s(t).parents(".inTreeNode"),r="";s.each(o.get().reverse(),function(e,t){r+=s(t).attr("data-intreenodealyas")+".subs."}),r+=n;var a=s(t).children(".inTreeInputWrapper").children(".inTreeNodeInput");s.each(a,function(e,t){p.assignValueToJsonTreeObject(i,r+"."+s(t).attr("name"),s(t).val())})}),i},generatedJsonController:function(){1==inputsTreeComponenets.jsonGenerateBtn&&p.inputsTreeComponenets.inputsTreeActionControllersDiv.append(s("<button></button>").text(p.inputsTreeComponenets.jsonGenerateBtnText).attr("class","jsonBtn").on("click",function(){var e=p.jsonTreeObjectBuild();switch(p.inputsTreeComponenets.jsonGenerateShowMethod){case"log":console.log(e);break;case"alert":alert(JSON.stringify(e));break;default:console.log(e)}})),1==inputsTreeComponenets.jsonActionBtn&&p.inputsTreeComponenets.inputsTreeActionControllersDiv.append(s("<button></button>").text(p.inputsTreeComponenets.jsonActionBtnText).attr("class","actionBtn").on("click",function(){var e=p.jsonTreeObjectBuild();p.generateJsonRequestAction(p.inputsTreeComponenets.jsonActionUrl,e)}))},assignValueToJsonTreeObject:function e(t,n,o){if("string"==typeof n&&(n=n.split(".")),1<n.length){var r=n.shift();e(t[r]="[object Object]"===Object.prototype.toString.call(t[r])?t[r]:{},n,o)}else t[n[0]]=o}};e.inputsTree=function(e){p.init(e)}}(jQuery,window,document);